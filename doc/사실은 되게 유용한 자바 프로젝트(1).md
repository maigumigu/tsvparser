# 사실은 되게 유용한 자바 프로젝트(1)



## Git

### 버전 관리 시스템

기본적으로 말해 소스 코드 관리 시스템.커밋 단위로 모든 소스 코드를 트래킹할 수 있음.각 커밋은 고유한 해시값을 가짐

일단 해시값 기준으로 코드 버전을 구분할 수 있음.

글고 커밋 기준으로 그 커밋에 매핑된 태그를 태깅하여 GPG, 정식 버전 등의 의미를 부여할 수 있음.

글고 커밋 해쉬 값을 가져와 특정 시점의 코드를 가져와서 현재 코드에 적용할 수 있음.(cherry pick)

,etc

![img](https://lh6.googleusercontent.com/WYKLsuuDyfbevEye5reBUYWT6OlK7lqKWHf6cvsUlnEjv8ACZ7hHmTayr5ljqEaEUeL8Qdq7D5iyiEiuu4r5yMKxIcEinrSu0r9IrVdSL9Y9T-tiXKBbqZ4ZgxL0D8bpJ7S_Nl8m)

**<노란색으로 해시값 일부가 명시되었음>**

### 일반적인 코드 관리 흐름

master branch가 주 흐름을 가진 branch가 되며, 프로젝트의 일부 기능을 구현할 때, 변경할 때 곁다리로 branch를 따서 구현함.구현이 완료되면 해당 branch를 master에 merge하는 방식으로 프로젝트 소스가 관리된다.

**![img](https://lh3.googleusercontent.com/P4KSUEfCqbxrUlIoAV30kuMLdOa_d-KF1ZE8UB7T4hPNBfjbmcEO23pcMAFgUtsuk_Kuq5Ovq996NYQbDk8WTAU9chO-BGClbQSh31MByaths7q8L2LY2RJgGKRBwrmHO2-a-UTq)**

**<프로젝트 브랜치 graph(빨간색이 master)>**

![img](https://lh6.googleusercontent.com/Vfr6f_e78vF_OqnYAVu_9yK2YTBM1UnJZRpayF7Q2Zs4mEHPlZSce8hAjayyBId2v-S72X9t5KsiuE2IIT-Nw6AeR_q7FYk3j4okOXpwYrqcuGAHyrShmXnWzxiq1YYvQ3NH6jQB)

## Gradle

### 빌드 툴

CICD의 요소 중에 하나인 '빌드 자동화' 툴이다.

Ant, Maven의 단점을 보완하여 만들어졌다고 들었는데 여러모로 확실히 편리하다.build빌드는 쉽게 말해 소스코드가 없는 executable file을 생성하는 것이라고 할 수 있다. 

### build.gradle

gradle init --type java-library 명령어나 IDE를 통해 Gradle project를 생성하면 다음과 같은 구조가 생겨난다. 이중에 build.gradle 파일에서 빌드 관련 다양한 설정을 할 수 있다. 
.
├── build.gradle
├── gradle
│   └── wrapper
│       ├── gradle-wrapper.jar
│       └── gradle-wrapper.properties
├── gradlew
├── gradlew.bat
├── settings.gradle
└── src
    ├── main
    │   └── java
    │       └── Library.java
    └── test
        └── java
            └── LibraryTest.java



아래는 명령어를 통해 기본적으로 생성되는 그래들 파일이다. IDE 마다 생성되는 build.gradle 파일의 내용이 조금씩 달라질 수는 있지만 아래 파일 수준으로 생성해준다.

```groovy
/* * This build file was generated by the Gradle 'init' task. * * This generated file contains a sample Java Library project to get you started. * For more details take a look at the Java Libraries chapter in the Gradle * user guide available at https://docs.gradle.org/4.4.1/userguide/java_library_plugin.html */
// Apply the java-library plugin to add support for Java Library

apply plugin: 'java-library'
// In this section you declare where to find the dependencies of your project

repositories {
 // Use jcenter for resolving your dependencies.  // You can declare any Maven/Ivy/file repository here.  
jcenter()
    
}
dependencies {
// This dependency is exported to consumers, that is to say found on their compile classpath.
api 'org.apache.commons:commons-math3:3.6.1'
  // This dependency is used internally, and not exposed to consumers on their own compile classpath.  
implementation 'com.google.guava:guava:23.0'
  // Use JUnit test framework 
testImplementation 'junit:junit:4.12'
}
```





#### **apply plugin: 'java-library'**

자바 기본 라이브러리를 plugin으로 적용해준다는 뜻이다.그래야 build할때 compileJava 과정을 통과할 수 있다.

#### **repositories**

외부 라이브러리를 다운로드할 원격 repository를 지정해준다.jcenter()나 mavenCentral()이 들어간다.

#### **dependencies**

의존하는 라이브러리들을 쭈르륵 적어준다.문법 구조가 [left size] [right side] 요런 식으로 적혀있는데, 

**compile group: 'commons-io', name: 'commons-io', version: '2.6'** 의 경우는 compile 작업을 할때 의존하는 라이브러리가 apache commons io라는 뜻이 된다. 왼쪽에 관련 작업이 나오고, 오른쪽에 의존하는 라이브러리가 나오는 구조이다.

#### gradle wrapper

wrapper는 말그대로 gradle 프로젝트를 싸주는 애다. gradle project를 다운로드한 컴퓨터에 JDK가 깔려있다면 gradle이 설치되어있지 않아도 해당 프로젝트 안에서 gradle build를 사용할 수 있다.

만약 컴퓨터에 gradle이 깔려있다면 프로젝트의 gradle 버전 기준으로 build가 실행된다. 이와 관련된 파일인 gradlew는 리눅스에서, gradlew.bat(배치파일)는 윈도우에서 gradle 명령어 대신 사용할 수 있다.

#### settings.gradle

gradle 프로젝트와 서브 프로젝트간의 관계성을 명시하는 파일이다. 지금은 아무것도 안했으므로 생성한 gradle 프로젝트만 명시되어있다.

## Gradle 프로젝트 생성하기

![img](https://lh6.googleusercontent.com/UqF9TSWusvMPfM0N05RM8Se-hDjSQ149RXeEaja8aVqYcBONg7vL-MbmLfJg8ZH1fm3GfQqjhHonyXfWs-tDOj5CMROcqjOzpeHA58--hNP2E4sblE_44Gos8HJXk_-ynGm_CCNz)
gradle, java 프로젝트를 선택해서 생성한다.

artifact id, group id는 맘대로 입력한다. 원래는 group id는 distinct한 프로젝트 구별을 위한것이고 artifact id는 jar파일이 그 이름으로 생기는 걸로 알고 있다. 

## 의존성 이해하기

```groovy
dependencies {  
    // This dependency is exported to consumers, that is to say found on their compile classpath.  
    api 'org.apache.commons:commons-math3:3.6.1'**
  // This dependency is used internally, and not exposed to consumers on their own compile classpath.  
    implementation 'com.google.guava:guava:23.0'**
  // Use JUnit test framework  testImplementation 'junit:junit:4.12'**}

```

쉽게 말해서 외부 라이브러리 dependencies 블록에 추가하면 jar 파일 안받고 쓸 수 있다. 아까봤던 dependencies에 외부 apache commons io를 추가해본다 

Maven Repository : https://mvnrepository.com/artifact/de.tudarmstadt.ukp.clarin.webanno/webanno-io-tsv/3.6.1 여기에 들어가서 apache commons io를 검색한뒤 jcentral -> gradle에 있는 내용을 그냥 복붙하면 된다.

```groovy
dependencies {  // This dependency is exported to consumers, that is to say found on their compile classpath.  
api 'org.apache.commons:commons-math3:3.6.1'
  // This dependency is used internally, and not exposed to consumers on their own compile classpath.  
  implementation 'com.google.guava:guava:23.0'
  // Use JUnit test framework  
  testImplementation 'junit:junit:4.12'
  // https://mvnrepository.com/artifact/commons-io/commons-io  
  compile group: 'commons-io', name: 'commons-io', version: '2.6'
}
```

commons io 소스 코드는 github에 있으므로 생략한다.빌드 과정 이해하기작성한 소스 코드를 executable 파일로 만들기 위해서는 꼭 필요한 두가지를 build.gradle에 추가해줘야 한다. 

첫번째,

apply plugin: ‘application’을 통해 application을 만드는 플러그인을 적용하기

두번째,

application {  mainClassName = 'main.java.Main'}로 메인 클래스를 지정해주기.

**build.gradle**

```groovy
/* * This build file was generated by the Gradle 'init' task. * * This generated file contains a sample Java Library project to get you started. * For more details take a look at the Java Libraries chapter in the Gradle * user guide available at https://docs.gradle.org/4.4.1/userguide/java_library_plugin.html */
// Apply the java-library plugin to add support for Java Library

apply plugin: 'java-library'
apply plugin: ‘application'
application {
    mainClassName ='main.java.Main'
}
// In this section you declare where to find the dependencies of your project

repositories {  
    // Use jcenter for resolving your dependencies.  
    // You can declare any Maven/Ivy/file repository here.  
jcenter()
}

dependencies {  
    // This dependency is exported to consumers, that is to say found on their compile classpath.  
api 'org.apache.commons:commons-math3:3.6.1'
  // This dependency is used internally, and not exposed to consumers on their own compile classpath.
    implementation 'com.google.guava:guava:23.0'
  // Use JUnit test framework 
testImplementation 'junit:junit:4.12'
}
```



그런다음 IntelliJ 개꿀 원클릭 기능을 사용해서 build를 실행한다.

![img](https://lh6.googleusercontent.com/PUYqucIC5fABehk-SXT9Yr-P44rgeM--oXtWgMb8zKbu7awdvqMAjVZ5REkzDN8bkJ3o6Us3b9TlgpS74N5WTHhnrKwfYVNnhBUHIIwDtWGCMr0M9QGNOoREY8vnLu2TvzjclI-1)



distZip을 실행하면 컴파일부터 다해주고 압축된 executable 파일을 생성해준다. 

그런 다음 ./build/distributions의 경로에 있는 zip 파일을 unzip 해준다.그런 다음 build/distributions/javastudy-1.0-SNAPSHOT/bin 아래에 있는 쉘파일을 실행해준다.![img](https://lh5.googleusercontent.com/wxYuhLaIZh4cuDR-0gVuKNTspY8kZJ4IDdh9yH9_9rDH2VsbhWX0zXoK80Z-c6H0ib__r0Cm6xb_CYUfzt4FAd8DNeY5oNoe08pMyDpypHC1Koq3ck6cH2QxoeK0RkInugIdRRYK)

**끝!끝!**
**오늘의 단축키**Ctrl + y 를 누르면 커서가 있는 라인을 삭제해준다.